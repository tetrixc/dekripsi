<html>
    <head>
        <link rel="stylesheet" href="https://pyscript.net/alpha/pyscript.css"/>
        <script defer src="https://pyscript.net/alpha/pyscript.js"></script>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"/>
    </head>
<body>
    <py-script>
        import string
def char_frequency(str1):
    dict = {}
    for n in str1:
        keys = dict.keys()
        if n in keys:
            dict[n] += 1
        else:
            dict[n] = 1

while True:
    inp_teks = input("Masukkan text: ")
    count = 0
    for i in range(0, len(inp_teks)):
        count = count + 1
    jumlah_text = (count)
    if len(inp_teks) % 3 != 0:
        print("Tidak Memenuhi")
        continue
    print("Memenuhi")
    break

code = []
code.append(input("Masukkan angka warna merah = "))
code.append(input("Masukkan angka warna hijau = "))
code.append(input("Masukkan angka warna biru = "))
print("code : ",code)

##Ini nanti jadine kaya code = ["abc","def","ghi"]
inp_hexa = input("Masukkan heksa: ")
#####Variabel input#######
key = list(inp_hexa)
key.reverse()
print("key : ",key)
#####Variabel 2#######
shiftk = []
for i in range(6):
    if key[i].isalpha() == True:
        input = key[i]
        input = input.lower()
        output = []
        for character in input:
            number = ord(character) - 96
            output.append(str(number))
        shiftk.append(int("".join(output)))
    else:
        shiftk.append(key[i])
print("shiftk",shiftk)
####vigenere chiper#####
angka_kunci = (int(shiftk[0]) * int(shiftk[1]) * int(shiftk[2]) * int(shiftk[3]) * int(shiftk[4]) * int(shiftk[5]))
kunci_jumlah = string.ascii_lowercase
plain_text = kunci_jumlah[:count]
inp_shi = int(angka_kunci)
shift = inp_shi
shift %= 26
alphabet = string.ascii_lowercase
shifted = alphabet[shift:] + alphabet[:shift]
table = str.maketrans(alphabet, shifted)
kb_2 = plain_text.translate(table)
count_text = jumlah_text
HURUF = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'
print("kb_2:",kb_2)
def main():
    pesanSaya = inp_teks
    kunciSaya = kb_2
    ubah = dekripsiPesan(kunciSaya, pesanSaya)
    pergeseran=ubah
    print("pt_5 :", pergeseran)
    for i in range(0, 6):
        if key[i].isalpha() == True:
            count_rotation = int(shiftk[i]) % int(count_text)
            count_right = int(count_text) - int(count_rotation)
            part_right = pergeseran[-count_right:]
            if count_rotation == 0:
                part_left = ''
            else:
                part_left = pergeseran[:count_rotation]
            pergeseran = (part_right + part_left)
        else:
            shift = 26 - int(shiftk[i])
            shift %= 26
            alphabet = string.ascii_lowercase
            shifted = alphabet[shift:] + alphabet[:shift]
            table = str.maketrans(alphabet, shifted)
            pergeseran = pergeseran.translate(table)
    print("pt_3:", pergeseran)
    Diskriminan_A = (int(code[0][0]) * int(code[1][1]) * int(code[2][2])) + (
                int(code[0][1]) * int(code[1][2]) * int(code[2][0])) + (
                            int(code[0][2]) * int(code[1][0]) * int(code[2][1])) - (
                                int(code[0][1]) * int(code[1][1]) * int(code[2][0])) - (
                            int(code[0][1]) * int(code[1][0]) * int(code[2][2])) - (
                                int(code[0][0]) * int(code[1][2]) * int(code[2][1]))
    count_rotation = int(Diskriminan_A) % int(count_text)
    count_right = int(count_text) - int(count_rotation)
    part_right = pergeseran[-count_right:]
    if count_rotation == 0:
        part_left = ''
    else:
        part_left = pergeseran[:count_rotation]
    hasil_kunci = (part_right + part_left)
    print("pt_4:",hasil_kunci)



    kunci_jumlah = string.ascii_lowercase
    if jumlah_text >= 26:
        hasil_jumlah = 26
    else:
        hasil_jumlah = count
    hasil_angka = kunci_jumlah[:hasil_jumlah]
    plain_text = hasil_angka
    shift = int(Diskriminan_A)
    shift %= 26
    alphabet = string.ascii_lowercase
    shifted = alphabet[shift:] + alphabet[:shift]
    table = str.maketrans(alphabet, shifted)
    encrypted = plain_text.translate(table)
    kb_1= encrypted
    print("kb_1 :",kb_1)
    hasil_key = hasil_kunci
    pesanSaya = hasil_key
    kunciSaya = kb_1
    ubah = dekripsiPesan(kunciSaya, pesanSaya)
    pt_3 = ubah
    print(pt_3)

    def trans(hasil):
        dekrip = ["", "", ""]
        for col in range(3):
            pointer = col
            while pointer < len(hasil):
                dekrip[col] += hasil[pointer]
                pointer += 3
        return dekrip

    plain = pt_3
    hasil = plain


    def vernamdek(plain, code):
        code1 = ["", "", ""]
        chiped = []
        t = 0
        for y in range(len(plain)):
            t = 0
            for i in range(len(plain[y])):
                for x in code[y]:
                    code1[y] += str(x)
                    if len(code1[y]) == len(plain[y]):
                        break
                if len(code1[y]) == len(plain[y]):
                    break

        for y in range(len(plain)):
            for i in range(len(plain[y])):
                if plain[y][i] == '_':
                    chiped.append(' ')
                else:
                    t = int((ord((plain[y][i].upper())) - 65) - int(code1[y][i]))
                    if (t + 65) < 65:
                        t += 26
                        chiped.append(chr(t + 65).lower())
                    else:
                        chiped.append(chr(t + 65).lower())
        return chiped

    def spliter(hasil):
        panjang = len(hasil)
        tes = ["", "", ""]
        for y in range(3):
            for i in hasil:
                tes[y] += i
                if len(tes[y]) == ((panjang - (panjang % 3)) / 3) + panjang % 3:
                    hasil = hasil[len(tes[y]):]
                    break

        return tes

    def decrypt(hasil):
        teks = ""
        for x in range(len(hasil[0])):
            for y in range(3):
                for i in hasil[y][x]:
                    teks += i
                    break
        return teks


    print("hasilnya : " + decrypt(spliter(vernamdek(spliter(hasil), code))))

def dekripsiPesan(kunci, pesan):
    return ubahPesan(kunci, pesan, 'dekripsi')


def ubahPesan(kunci, pesan, mode):
    ubah = []
    kunciIndex = 0
    kunci = kunci.upper()

    for symbol in pesan:
        nomor = HURUF.find(symbol.upper())
        if nomor != -1:
            if mode == 'dekripsi':
                nomor -= HURUF.find(kunci[kunciIndex])  # kurangi jika melakukan dekripsi
            nomor %= len(HURUF)

            if symbol.isupper():
                ubah.append(HURUF[nomor])
            elif symbol.islower():
                ubah.append(HURUF[nomor].lower())

            kunciIndex += 1
            if kunciIndex == len(kunci):
                kunciIndex = 0

        else:
            ubah.append(symbol)

    return ''.join(ubah)
if __name__ == '__main__':
    main()

    </py-script>

</body>
</html>
